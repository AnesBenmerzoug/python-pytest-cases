



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1, mkdocs-material-4.6.3">
    
    
      
        <title>pytest_cases</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.adb8469c.css">
      
      
    
    
      <script src="assets/javascripts/modernizr.86422ebf.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#pytest-cases" tabindex="0" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="." title="pytest_cases" aria-label="pytest_cases" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              pytest_cases
            </span>
            <span class="md-header-nav__topic">
              
                Home
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" aria-label="search" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/smarie/python-pytest-cases/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="." title="pytest_cases" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    pytest_cases
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/smarie/python-pytest-cases/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Home
      </label>
    
    <a href="." title="Home" class="md-nav__link md-nav__link--active">
      Home
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-data-cases" class="md-nav__link">
    Usage - 'Data' cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-some-code-to-test" class="md-nav__link">
    a- Some code to test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-case-functions" class="md-nav__link">
    b- Case functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-test-functions" class="md-nav__link">
    c- Test functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-case-fixtures" class="md-nav__link">
    d- Case fixtures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-true-test-cases" class="md-nav__link">
    Usage - 'True' test cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-case-functions-update" class="md-nav__link">
    a- Case functions update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-test-body-update" class="md-nav__link">
    b- Test body update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytest-goodies" class="md-nav__link">
    pytest Goodies
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-with-reorder" class="md-nav__link">
    --with-reorder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_plus" class="md-nav__link">
    @fixture_plus
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpack_fixture-unpack_into" class="md-nav__link">
    unpack_fixture / unpack_into
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#param_fixtures" class="md-nav__link">
    param_fixture[s]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_union" class="md-nav__link">
    fixture_union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametrize_plus" class="md-nav__link">
    @parametrize_plus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Usage details
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Usage details
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="usage/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="usage/basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="usage/intermediate/" title="Intermediate" class="md-nav__link">
      Intermediate
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="usage/advanced/" title="Advanced" class="md-nav__link">
      Advanced
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="api_reference/" title="API reference" class="md-nav__link">
      API reference
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="changelog/" title="Changelog" class="md-nav__link">
      Changelog
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#installing" class="md-nav__link">
    Installing
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-data-cases" class="md-nav__link">
    Usage - 'Data' cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-some-code-to-test" class="md-nav__link">
    a- Some code to test
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-case-functions" class="md-nav__link">
    b- Case functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#c-test-functions" class="md-nav__link">
    c- Test functions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#d-case-fixtures" class="md-nav__link">
    d- Case fixtures
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage-true-test-cases" class="md-nav__link">
    Usage - 'True' test cases
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#a-case-functions-update" class="md-nav__link">
    a- Case functions update
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#b-test-body-update" class="md-nav__link">
    b- Test body update
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pytest-goodies" class="md-nav__link">
    pytest Goodies
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#-with-reorder" class="md-nav__link">
    --with-reorder
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_plus" class="md-nav__link">
    @fixture_plus
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unpack_fixture-unpack_into" class="md-nav__link">
    unpack_fixture / unpack_into
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#param_fixtures" class="md-nav__link">
    param_fixture[s]
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fixture_union" class="md-nav__link">
    fixture_union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parametrize_plus" class="md-nav__link">
    @parametrize_plus
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#main-features-benefits" class="md-nav__link">
    Main features / benefits
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#see-also" class="md-nav__link">
    See Also
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#others" class="md-nav__link">
    Others
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#want-to-contribute" class="md-nav__link">
    Want to contribute ?
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/smarie/python-pytest-cases/edit/master/docs/index.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="pytest-cases">pytest-cases<a class="headerlink" href="#pytest-cases" title="Permanent link">&para;</a></h1>
<p><em>Separate test code from test cases in <code>pytest</code>.</em></p>
<p><a href="https://pypi.python.org/pypi/pytest-cases/"><img alt="Python versions" src="https://img.shields.io/pypi/pyversions/pytest-cases.svg" /></a> <a href="https://travis-ci.org/smarie/python-pytest-cases"><img alt="Build Status" src="https://travis-ci.org/smarie/python-pytest-cases.svg?branch=master" /></a> <a href="https://smarie.github.io/python-pytest-cases/junit/report.html"><img alt="Tests Status" src="https://smarie.github.io/python-pytest-cases/junit/junit-badge.svg?dummy=8484744" /></a> <a href="https://codecov.io/gh/smarie/python-pytest-cases"><img alt="codecov" src="https://codecov.io/gh/smarie/python-pytest-cases/branch/master/graph/badge.svg" /></a></p>
<p><a href="https://smarie.github.io/python-pytest-cases/"><img alt="Documentation" src="https://img.shields.io/badge/doc-latest-blue.svg" /></a> <a href="https://pypi.python.org/pypi/pytest-cases/"><img alt="PyPI" src="https://img.shields.io/pypi/v/pytest-cases.svg" /></a> <a href="https://pepy.tech/project/pytest-cases"><img alt="Downloads" src="https://pepy.tech/badge/pytest-cases" /></a> <a href="https://pepy.tech/project/pytest-cases"><img alt="Downloads per week" src="https://pepy.tech/badge/pytest-cases/week" /></a> <a href="https://github.com/smarie/python-pytest-cases/stargazers"><img alt="GitHub stars" src="https://img.shields.io/github/stars/smarie/python-pytest-cases.svg" /></a></p>
<div class="admonition success">
<p class="admonition-title">New <code>unpacking feature</code>, <a href="#unpack_fixture-unpack_into">check it out</a> !</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Test execution order</p>
<p>Installing pytest-cases now has effects on the order of <code>pytest</code> tests execution, even if you do not use its features. One positive side effect is that it fixed <a href="https://github.com/pytest-dev/pytest/issues/5054">pytest#5054</a>. But if you see less desirable ordering please <a href="https://github.com/smarie/python-pytest-cases/issues">report it</a>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">New aliases</p>
<p><code>pytest_fixture_plus</code> and <code>pytest_parametrize_plus</code> were renamed to <code>fixture_plus</code> and <code>parametrize_plus</code> in order for pytest (pluggy) not to think they were hooks. Old aliases will stay around for a few versions, with a deprecation warning. See <a href="https://github.com/smarie/python-pytest-cases/issues/71">#71</a>.</p>
</div>
<p>Did you ever think that most of your test functions were actually <em>the same test code</em>, but with <em>different data inputs</em> and expected results/exceptions ?</p>
<p><code>pytest-cases</code> leverages <code>pytest</code> and its great <code>@pytest.mark.parametrize</code> decorator, so that you can <strong>separate your test cases from your test functions</strong>. For example with <code>pytest-cases</code> you can now write your tests with the following pattern:</p>
<ul>
<li>on one hand, the usual <code>test_xxxx.py</code> file containing your test functions</li>
<li>on the other hand, a new <code>test_xxxx_cases.py</code> containing your cases functions</li>
</ul>
<p><code>pytest-cases</code> is fully compliant with <a href="https://smarie.github.io/python-pytest-steps/">pytest-steps</a> so you can create test suites with several steps and send each case on the full suite. See <a href="./usage/advanced/#test-suites-several-steps-on-each-case">usage page for details</a>.</p>
<h2 id="installing">Installing<a class="headerlink" href="#installing" title="Permanent link">&para;</a></h2>
<div class="codehilite"><pre><span></span><code>&gt; pip install pytest_cases
</code></pre></div>


<h2 id="usage-data-cases">Usage - 'Data' cases<a class="headerlink" href="#usage-data-cases" title="Permanent link">&para;</a></h2>
<h3 id="a-some-code-to-test">a- Some code to test<a class="headerlink" href="#a-some-code-to-test" title="Permanent link">&para;</a></h3>
<p>Let's consider the following <code>foo</code> function under test:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">b</span> <span class="o">+</span> <span class="mi">1</span>
</code></pre></div>


<h3 id="b-case-functions">b- Case functions<a class="headerlink" href="#b-case-functions" title="Permanent link">&para;</a></h3>
<p>First we create a <code>test_foo_cases.py</code> file. This file will contain <em>test cases generator</em> functions, that we will call <strong>case functions</strong> for brevity:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">case_two_positive_ints</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Inputs are two positive integers &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">case_two_negative_ints</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Inputs are two negative integers &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>


<p>In these functions, you will typically either parse some test data files, or generate some simulated test data and expected results. </p>
<p>Case functions <strong>do not have any particular requirement</strong>, apart from their names starting with <code>case_</code>. They can return anything that is considered useful to run the associated test. </p>
<div class="admonition note">
<p class="admonition-title">Support for pytest marks</p>
<p>Pytest marks such as <code>@pytest.mark.skip</code> can be used on case functions, the corresponding case will be handled according to the expected behaviour (failed if <code>@pytest.mark.fail</code>, skipped under condition if <code>@pytest.mark.skipif</code>, etc.)</p>
</div>
<h3 id="c-test-functions">c- Test functions<a class="headerlink" href="#c-test-functions" title="Permanent link">&para;</a></h3>
<p>Then, as usual we write our <code>pytest</code> functions starting with <code>test_</code>, in a <code>test_foo.py</code> file:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">cases_data</span>
<span class="kn">from</span> <span class="nn">example</span> <span class="kn">import</span> <span class="n">foo</span>

<span class="c1"># import the module containing the test cases</span>
<span class="kn">import</span> <span class="nn">test_foo_cases</span>

<span class="nd">@cases_data</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">test_foo_cases</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">case_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Example unit test that is automatically parametrized with @cases_data &quot;&quot;&quot;</span>

    <span class="c1"># 1- Grab the test case data</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">case_data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="c1"># 2- Use it</span>
    <span class="n">foo</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>


<p><em>Note: as explained <a href="https://smarie.github.io/python-pytest-cases/usage/basics/#cases-in-the-same-file-than-tests">here</a>, cases can also be located inside the test file.</em></p>
<p>As you can see above there are three things that are needed to parametrize a test function with associated case functions:</p>
<ul>
<li>decorate your test function with <code>@cases_data</code>, indicating which module contains the cases functions</li>
<li>add an input argument to your test function, named <code>case_data</code> with optional type hint <code>CaseData</code></li>
<li>use that input argument at the beginning of the test function, to retrieve the test data: <code>inputs = case_data.get()</code></li>
</ul>
<p>Once you have done these three steps, executing <code>pytest</code> will run your test function <strong>once for every case function</strong>:</p>
<div class="codehilite"><pre><span></span><code>&gt;&gt;&gt; <span class="nv">pytest</span>
<span class="o">=============================</span> <span class="nb">test</span> session <span class="nv">starts</span> <span class="o">=============================</span>
<span class="o">(</span>...<span class="o">)</span>
&lt;your_project&gt;/tests/test_foo.py::test_foo<span class="o">[</span>case_two_positive_ints<span class="o">]</span> PASSED <span class="o">[</span> <span class="m">50</span>%<span class="o">]</span>
&lt;your_project&gt;/tests/test_foo.py::test_foo<span class="o">[</span>case_two_negative_ints<span class="o">]</span> PASSED <span class="o">[</span> <span class="m">100</span>%<span class="o">]</span>

<span class="o">==========================</span> <span class="m">2</span> passed in <span class="m">0</span>.24 <span class="nv">seconds</span> <span class="o">==========================</span>
</code></pre></div>


<h3 id="d-case-fixtures">d- Case fixtures<a class="headerlink" href="#d-case-fixtures" title="Permanent link">&para;</a></h3>
<p>You might be concerned that case data is gathered or created <em>during</em> test execution. </p>
<p>Indeed creating or collecting case data is not part of the test <em>per se</em>. Besides, if you benchmark your tests durations (for example with <a href="https://smarie.github.io/python-pytest-harvest/">pytest-harvest</a>), you may want the test duration to be computed without acccounting for the data retrieval time - especially if you decide to add some caching mechanism as explained <a href="https://smarie.github.io/python-pytest-cases/usage/advanced/#caching">here</a>.</p>
<p>It might therefore be more interesting for you to parametrize <strong>case fixtures</strong> instead of parametrizing your test function. Thanks to our new <a href="#pytest_fixture_plus"><code>@fixture_plus</code></a> decorator, this works exactly the same way than for test functions:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">fixture_plus</span><span class="p">,</span> <span class="n">cases_data</span>
<span class="kn">from</span> <span class="nn">example</span> <span class="kn">import</span> <span class="n">foo</span>

<span class="c1"># import the module containing the test cases</span>
<span class="kn">import</span> <span class="nn">test_foo_cases</span>

<span class="nd">@fixture_plus</span>
<span class="nd">@cases_data</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">test_foo_cases</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">inputs</span><span class="p">(</span><span class="n">case_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Example fixture that is automatically parametrized with @cases_data &quot;&quot;&quot;</span>
    <span class="c1"># retrieve case data</span>
    <span class="k">return</span> <span class="n">case_data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">inputs</span><span class="p">):</span>
    <span class="c1"># Use case data</span>
    <span class="n">foo</span><span class="p">(</span><span class="o">**</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>


<p>In the above example, the <code>test_foo</code> test does not spend time collecting or generating data. When it is executed, it receives the required data directly as <code>inputs</code>. The test case creation instead happens when each <code>inputs</code> fixture instance is created by <code>pytest</code> - this is done in a separate pytest phase (named "setup"), and therefore is not counted in the test duration.</p>
<p>Note: you can still use <code>request</code> in your fixture's signature if you wish to.</p>
<h2 id="usage-true-test-cases">Usage - 'True' test cases<a class="headerlink" href="#usage-true-test-cases" title="Permanent link">&para;</a></h2>
<h4 id="a-case-functions-update">a- Case functions update<a class="headerlink" href="#a-case-functions-update" title="Permanent link">&para;</a></h4>
<p>In the above example the cases were only containing inputs for the function to test. In real-world applications we often need more: we need both inputs <strong>and an expected outcome</strong>. </p>
<p>For this, <code>pytest_cases</code> proposes to adopt a convention where the case functions returns a tuple of inputs/outputs/errors. A handy <code>CaseData</code> PEP484 type hint can be used to denote that. But of course this is only a proposal, which is not mandatory as we saw above.</p>
<div class="admonition note">
<p class="admonition-title">A case function can return <strong>anything</strong></p>
<p>Even if in most examples in this documentation we chose to return a tuple (inputs/outputs/errors) (type hint <code>CaseData</code>), you can decide to return anything: a single variable, a dictionary, a tuple of a different length, etc. Whatever you return will be available through <code>case_data.get()</code>.</p>
</div>
<p>Here is how we can rewrite our case functions with an expected outcome:</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span> <span class="nf">case_two_positive_ints</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CaseData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Inputs are two positive integers &quot;&quot;&quot;</span>

    <span class="n">ins</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>

    <span class="k">return</span> <span class="n">ins</span><span class="p">,</span> <span class="n">outs</span><span class="p">,</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">case_two_negative_ints</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">CaseData</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Inputs are two negative integers &quot;&quot;&quot;</span>

    <span class="n">ins</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">outs</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">return</span> <span class="n">ins</span><span class="p">,</span> <span class="n">outs</span><span class="p">,</span> <span class="kc">None</span>
</code></pre></div>


<p>We propose that the "expected error" (<code>None</code> above) may contain exception type, exception instances, or callables. If you follow this convention, you will be able to write your test more easily with the provided utility function <code>unfold_expected_err</code>. See <a href="https://smarie.github.io/python-pytest-cases/usage/basics/#handling-exceptions">here for details</a>.</p>
<h3 id="b-test-body-update">b- Test body update<a class="headerlink" href="#b-test-body-update" title="Permanent link">&para;</a></h3>
<p>With our new case functions, a case will be made of three items. So <code>case_data.get()</code> will return a tuple. Here is how we can update our test function body to retrieve it correctly, and check that the outcome is as expected:</p>
<div class="codehilite"><pre><span></span><code><span class="nd">@cases_data</span><span class="p">(</span><span class="n">module</span><span class="o">=</span><span class="n">test_foo_cases</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">test_foo</span><span class="p">(</span><span class="n">case_data</span><span class="p">:</span> <span class="n">CaseDataGetter</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Example unit test that is automatically parametrized with @cases_data &quot;&quot;&quot;</span>

    <span class="c1"># 1- Grab the test case data: now a tuple !</span>
    <span class="n">i</span><span class="p">,</span> <span class="n">expected_o</span><span class="p">,</span> <span class="n">expected_e</span> <span class="o">=</span> <span class="n">case_data</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

    <span class="c1"># 2- Use it: we can now do some asserts !</span>
    <span class="k">if</span> <span class="n">expected_e</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># **** Nominal test ****</span>
        <span class="n">outs</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">outs</span> <span class="o">==</span> <span class="n">expected_o</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># **** Error tests: see &lt;Usage&gt; page to fill this ****</span>
        <span class="k">pass</span>
</code></pre></div>


<p>See <a href="./usage">Usage</a> for complete examples with custom case names, case generators, exceptions handling, and more.</p>
<h2 id="pytest-goodies"><code>pytest</code> Goodies<a class="headerlink" href="#pytest-goodies" title="Permanent link">&para;</a></h2>
<h3 id="-with-reorder"><code>--with-reorder</code><a class="headerlink" href="#-with-reorder" title="Permanent link">&para;</a></h3>
<p><code>pytest</code> postprocesses the order of the collected items in order to optimize setup/teardown of session, module and class fixtures. This optimization algorithm happens at the <code>pytest_collection_modifyitems</code> stage, and is still under improvement, as can be seen in <a href="https://github.com/pytest-dev/pytest/pull/3551">pytest#3551</a>, <a href="https://github.com/pytest-dev/pytest/issues/3393">pytest#3393</a>, <a href="https://github.com/pytest-dev/pytest/issues/2846">#2846</a>...</p>
<p>Besides other plugins such as <a href="https://github.com/not-raspberry/pytest_reorder">pytest-reorder</a> can modify the order as well.</p>
<p>This new commandline is a goodie to change the reordering:</p>
<ul>
<li>
<p><code>--with-reorder normal</code> is the default behaviour: it lets pytest and all the plugins execute their reordering in each of their <code>pytest_collection_modifyitems</code> hooks, and simply does not interact </p>
</li>
<li>
<p><code>--with-reorder skip</code> allows you to restore the original order that was active before <code>pytest_collection_modifyitems</code> was initially called, thus not taking into account any reordering done by pytest or by any of its plugins.</p>
</li>
</ul>
<h3 id="fixture_plus"><code>@fixture_plus</code><a class="headerlink" href="#fixture_plus" title="Permanent link">&para;</a></h3>
<p><code>@fixture_plus</code> is similar to <code>pytest.fixture</code> but without its <code>param</code> and <code>ids</code> arguments. Instead, it is able to pick the parametrization from <code>@pytest.mark.parametrize</code> marks applied on fixtures. This makes it very intuitive for users to parametrize both their tests and fixtures. As a bonus, its <code>name</code> argument works even in old versions of pytest (which is not the case for <code>fixture</code>).</p>
<p>Finally it now supports unpacking, see <a href="#unpack_fixture-unpack_into">unpacking feature</a>.</p>
<div class="admonition note">
<p class="admonition-title"><code>@fixture_plus</code> deprecation if/when <code>@pytest.fixture</code> supports <code>@pytest.mark.parametrize</code></p>
<p>The ability for pytest fixtures to support the <code>@pytest.mark.parametrize</code> annotation is a feature that clearly belongs to <code>pytest</code> scope, and has been <a href="https://github.com/pytest-dev/pytest/issues/3960">requested already</a>. It is therefore expected that <code>@fixture_plus</code> will be deprecated in favor of <code>@pytest_fixture</code> if/when the <code>pytest</code> team decides to add the proposed feature. As always, deprecation will happen slowly across versions (at least two minor, or one major version update) so as for users to have the time to update their code bases.</p>
</div>
<h3 id="unpack_fixture-unpack_into"><code>unpack_fixture</code> / <code>unpack_into</code><a class="headerlink" href="#unpack_fixture-unpack_into" title="Permanent link">&para;</a></h3>
<p>In some cases fixtures return a tuple or a list of items. It is not easy to refer to a single of these items in a test or another fixture. With <code>unpack_fixture</code> you can easily do it:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">unpack_fixture</span><span class="p">,</span> <span class="n">fixture_plus</span>

<span class="nd">@fixture_plus</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">unpack_fixture</span><span class="p">(</span><span class="s2">&quot;a,b&quot;</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span>
</code></pre></div>


<p>Note that you can also use the <code>unpack_into=</code> argument of <code>@fixture_plus</code> to do the same thing:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">fixture_plus</span>

<span class="nd">@fixture_plus</span><span class="p">(</span><span class="n">unpack_into</span><span class="o">=</span><span class="s2">&quot;a,b&quot;</span><span class="p">)</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">test_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span>
</code></pre></div>


<p>And it is also available in <code>fixture_union</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">fixture_plus</span><span class="p">,</span> <span class="n">fixture_union</span>

<span class="nd">@fixture_plus</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">,</span> <span class="s1">&#39;world&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="nd">@fixture_plus</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;yeepee&#39;</span><span class="p">,</span> <span class="s1">&#39;yay&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">o</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">o</span><span class="p">,</span> <span class="n">o</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">fixture_union</span><span class="p">(</span><span class="s2">&quot;c_or_d&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">],</span> <span class="n">unpack_into</span><span class="o">=</span><span class="s2">&quot;a, b&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">test_function</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">b</span>
</code></pre></div>


<h3 id="param_fixtures"><code>param_fixture[s]</code><a class="headerlink" href="#param_fixtures" title="Permanent link">&para;</a></h3>
<p>If you wish to share some parameters across several fixtures and tests, it might be convenient to have a fixture representing this parameter. This is relatively easy for single parameters, but a bit harder for parameter tuples.</p>
<p>The two utilities functions <code>param_fixture</code> (for a single parameter name) and <code>param_fixtures</code> (for a tuple of parameter names) handle the difficulty for you:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">param_fixtures</span><span class="p">,</span> <span class="n">param_fixture</span>

<span class="c1"># create a single parameter fixture</span>
<span class="n">my_parameter</span> <span class="o">=</span> <span class="n">param_fixture</span><span class="p">(</span><span class="s2">&quot;my_parameter&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">fixture_uses_param</span><span class="p">(</span><span class="n">my_parameter</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">test_uses_param</span><span class="p">(</span><span class="n">my_parameter</span><span class="p">,</span> <span class="n">fixture_uses_param</span><span class="p">):</span>
    <span class="o">...</span>

<span class="c1"># -----</span>
<span class="c1"># create a 2-tuple parameter fixture</span>
<span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span> <span class="o">=</span> <span class="n">param_fixtures</span><span class="p">(</span><span class="s2">&quot;arg1, arg2&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)])</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">fixture_uses_param2</span><span class="p">(</span><span class="n">arg2</span><span class="p">):</span>
    <span class="o">...</span>

<span class="k">def</span> <span class="nf">test_uses_param2</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="n">fixture_uses_param2</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>


<h3 id="fixture_union"><code>fixture_union</code><a class="headerlink" href="#fixture_union" title="Permanent link">&para;</a></h3>
<p>As of <code>pytest</code> 4, it is not possible to create a "union" fixture, i.e. a parametrized fixture that will first take all the possible values of fixture A, then all possible values of fixture B, etc. </p>
<p>The topic has been largely discussed in <a href="https://github.com/pytest-dev/pytest/issues/349">pytest-dev#349</a> and a <a href="https://docs.pytest.org/en/latest/proposals/parametrize_with_fixtures.html">request for proposal</a> has been finally made.</p>
<p><code>fixture_union</code> is an implementation of this proposal.</p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">fixture_plus</span><span class="p">,</span> <span class="n">fixture_union</span>

<span class="nd">@fixture_plus</span>
<span class="k">def</span> <span class="nf">first</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;hello&#39;</span>

<span class="nd">@fixture_plus</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">second</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">param</span>

<span class="c1"># c will first take all the values of &#39;first&#39;, then all of &#39;second&#39;</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">fixture_union</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">first</span><span class="p">,</span> <span class="n">second</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">test_basic_union</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</code></pre></div>


<p>yields</p>
<div class="codehilite"><pre><span></span><code>&lt;...&gt;::test_basic_union[c_is_first] hello   PASSED
&lt;...&gt;::test_basic_union[c_is_second-a] a    PASSED
&lt;...&gt;::test_basic_union[c_is_second-b] b    PASSED
</code></pre></div>


<p>As you can see the ids of union fixtures are slightly different from standard ids, so that you can easily understand what is going on. You can change this feature with <code>ìdstyle</code>, see <a href="api_reference/#fixture_union">API documentation</a> for details.</p>
<p>This feature has been tested in very complex cases (several union fixtures, fixtures that are not selected by a given union but that is requested by the test function, etc.). But if you find some strange behaviour don't hesitate to report it in the <a href="https://github.com/smarie/python-pytest-cases/issues">issues</a> page !</p>
<p><strong>IMPORTANT</strong> if you do not use <code>@fixture_plus</code> but only <code>@pytest.fixture</code>, then you will see that your fixtures are called even when they are not used, with a parameter <code>NOT_USED</code>. This symbol is automatically ignored if you use <code>@fixture_plus</code>, otherwise you have to handle it.</p>
<div class="admonition note">
<p class="admonition-title">fixture unions vs. cases</p>
<p>If you're familiar with <code>pytest-cases</code> already, you might note <code>@cases_data</code> is not so different than a fixture union: we do a union of all case functions. If one day union fixtures are directly supported by <code>pytest</code>, we will probably refactor this lib to align all the concepts.</p>
</div>
<p>Finally fixture unions now supports unpacking, see <a href="#unpack_fixture-unpack_into">unpacking feature</a>.</p>
<h3 id="parametrize_plus"><code>@parametrize_plus</code><a class="headerlink" href="#parametrize_plus" title="Permanent link">&para;</a></h3>
<p><code>@parametrize_plus</code> is a replacement for <code>@pytest.mark.parametrize</code> that allows you to include references to fixtures in the parameter values. Simply use <code>fixture_ref(&lt;fixture&gt;)</code> in the parameter values, where <code>&lt;fixture&gt;</code> can be the fixture name or fixture function.</p>
<p>For example:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span> <span class="nn">pytest</span>
<span class="kn">from</span> <span class="nn">pytest_cases</span> <span class="kn">import</span> <span class="n">parametrize_plus</span><span class="p">,</span> <span class="n">fixture_plus</span><span class="p">,</span> <span class="n">fixture_ref</span>

<span class="nd">@pytest</span><span class="o">.</span><span class="n">fixture</span>
<span class="k">def</span> <span class="nf">world_str</span><span class="p">():</span>
    <span class="k">return</span> <span class="s1">&#39;world&#39;</span>

<span class="nd">@fixture_plus</span>
<span class="nd">@parametrize_plus</span><span class="p">(</span><span class="s1">&#39;who&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">fixture_ref</span><span class="p">(</span><span class="n">world_str</span><span class="p">),</span> 
                                 <span class="s1">&#39;you&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">greetings</span><span class="p">(</span><span class="n">who</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;hello &#39;</span> <span class="o">+</span> <span class="n">who</span>

<span class="nd">@parametrize_plus</span><span class="p">(</span><span class="s1">&#39;main_msg&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;nothing&#39;</span><span class="p">,</span> 
                                      <span class="n">fixture_ref</span><span class="p">(</span><span class="n">world_str</span><span class="p">),</span> 
                                      <span class="n">fixture_ref</span><span class="p">(</span><span class="n">greetings</span><span class="p">)])</span>
<span class="nd">@pytest</span><span class="o">.</span><span class="n">mark</span><span class="o">.</span><span class="n">parametrize</span><span class="p">(</span><span class="s1">&#39;ending&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">test_prints</span><span class="p">(</span><span class="n">main_msg</span><span class="p">,</span> <span class="n">ending</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">main_msg</span> <span class="o">+</span> <span class="n">ending</span><span class="p">)</span>
</code></pre></div>


<p>yields the following</p>
<div class="codehilite"><pre><span></span><code>&gt; pytest -s -v
collected <span class="m">9</span> items
test_prints<span class="o">[</span>test_prints_main_msg_is_0-nothing-?<span class="o">]</span> nothing?                                 PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_0-nothing-!<span class="o">]</span> nothing!                                 PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_world_str-?<span class="o">]</span> world?                                   PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_world_str-!<span class="o">]</span> world!                                   PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_greetings-greetings_who_is_world_str-?<span class="o">]</span> hello world?  PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_greetings-greetings_who_is_world_str-!<span class="o">]</span> hello world!  PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_greetings-greetings_who_is_1-you-?<span class="o">]</span> hello you?        PASSED
test_prints<span class="o">[</span>test_prints_main_msg_is_greetings-greetings_who_is_1-you-!<span class="o">]</span> hello you!        PASSED
</code></pre></div>


<p>As you can see, the ids are a bit more explicit than usual. As opposed to <code>fixture_union</code>, the style of these ids is not configurable for now but feel free to propose alternatives in the <a href="https://github.com/smarie/python-pytest-cases/issues">issues page</a>.</p>
<p>Note: for this to be performed, the parameters are replaced with a union fixture. Therefore the relative priority order of these parameters with other standard <code>pytest.mark.parametrize</code> parameters that you would place on the same function, will get impacted. You may solve this by replacing your mark parameters with <code>param_fixture</code>s (see <a href="#param_fixtures">above</a>.)</p>
<h2 id="main-features-benefits">Main features / benefits<a class="headerlink" href="#main-features-benefits" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><strong>Separation of concerns</strong>: test code on one hand, test cases data on the other hand. This is particularly relevant for data science projects where a lot of test datasets are used on the same block of test code.</p>
</li>
<li>
<p><strong>Everything in the test or in the fixture</strong>, not outside. A side-effect of <code>@pytest.mark.parametrize</code> is that users tend to create or parse their datasets outside of the test function. <code>pytest_cases</code> suggests a model where the potentially time and memory consuming step of case data generation/retrieval is performed <em>inside</em> the test node or the required fixture, thus keeping every test case run more independent. It is also easy to put debug breakpoints on specific test cases.</p>
</li>
<li>
<p><strong>Easier iterable-based test case generation</strong>. If you wish to generate several test cases using the same function, <code>@cases_generator</code> makes it very intuitive to do so. See <a href="./usage#case-generators">here</a> for details.</p>
</li>
<li>
<p><strong>User-friendly features</strong>: easily customize your test cases with friendly names, reuse the same cases for different test functions by tagging/filtering, and more... See <a href="./usage">Usage</a> for details.</p>
</li>
</ul>
<h2 id="see-also">See Also<a class="headerlink" href="#see-also" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://docs.pytest.org/en/latest/parametrize.html">pytest documentation on parametrize</a></li>
<li><a href="https://docs.pytest.org/en/latest/fixture.html#fixture-parametrize">pytest documentation on fixtures</a></li>
<li><a href="https://smarie.github.io/python-pytest-steps/">pytest-steps</a></li>
<li><a href="https://smarie.github.io/python-pytest-harvest/">pytest-harvest</a></li>
</ul>
<h3 id="others">Others<a class="headerlink" href="#others" title="Permanent link">&para;</a></h3>
<p><em>Do you like this library ? You might also like <a href="https://github.com/smarie/OVERVIEW#python">my other python libraries</a></em> </p>
<h2 id="want-to-contribute">Want to contribute ?<a class="headerlink" href="#want-to-contribute" title="Permanent link">&para;</a></h2>
<p>Details on the github page: <a href="https://github.com/smarie/python-pytest-cases">https://github.com/smarie/python-pytest-cases</a></p>
                
                  
                
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
        
          <a href="usage/" title="Overview" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Overview
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org" target="_blank" rel="noopener">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.c33a9706.js"></script>
      
      <script>app.initialize({version:"1.1",url:{base:"."}})</script>
      
    
  </body>
</html>